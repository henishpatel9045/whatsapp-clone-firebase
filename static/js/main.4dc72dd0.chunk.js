(this["webpackJsonpwhatsapp-clone"]=this["webpackJsonpwhatsapp-clone"]||[]).push([[0],{69:function(e,t,a){},70:function(e,t,a){},71:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){"use strict";a.r(t);var c=a(2),s=a.n(c),n=a(28),i=a.n(n),r=a(14),o=(a(69),a(70),a(106)),j=a(101),d=a(57),l=a.n(d),u=a(58),h=a.n(u),b=a(44),m=a.n(b),O=a(102),p=(a(71),a(31)),x=p.a.initializeApp({apiKey:"AIzaSyDZF_T2L4yn_cosRI2DePiZPizjEP-ahS8",authDomain:"what-sappclone-10b89.firebaseapp.com",projectId:"what-sappclone-10b89",storageBucket:"what-sappclone-10b89.appspot.com",messagingSenderId:"705061848533",appId:"1:705061848533:web:89c40018b15f8ca56fe95c",measurementId:"G-9XDEP88H7Q"}).firestore(),v=p.a.auth(),f=new p.a.auth.GoogleAuthProvider,g=x,_=a(32),N=a(4);var S=function(e){var t,a=Object(c.useState)(""),s=Object(r.a)(a,2),n=s[0],i=s[1],j=Object(c.useState)(""),d=Object(r.a)(j,2),l=d[0],u=d[1];Object(c.useEffect)((function(){i(Math.floor(5e3*Math.random())),e.id&&g.collection("rooms").doc(e.id).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){u(e.docs.map((function(e){return e.data()})))}))}),[e.id]);var h=!1;return!e.addNewChat||h?Object(N.jsx)(_.b,{to:"/rooms/".concat(e.id),children:Object(N.jsxs)("div",{className:"sidebarChat",children:[Object(N.jsx)(o.a,{src:"https://avatars.dicebear.com/api/human/".concat(n,".svg")}),Object(N.jsxs)("div",{className:"sidebarChat__info",children:[Object(N.jsx)("h2",{children:e.name}),Object(N.jsx)("p",{children:null===(t=l[0])||void 0===t?void 0:t.messages})]})]})}):Object(N.jsxs)("div",{onClick:function(){var e=prompt("Room Name? ");e&&g.collection("rooms").add({name:e})},className:"sidebarChat addNewChat",children:[Object(N.jsx)("h2",{children:"Add New Chat"}),h=!0]})};var w=function(e){var t,a=Object(c.useState)([]),s=Object(r.a)(a,2),n=s[0],i=s[1],d=Object(c.useState)(""),u=Object(r.a)(d,2),b=u[0],p=u[1];return Object(c.useEffect)((function(){var e=g.collection("rooms").onSnapshot((function(e){i(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]),Object(N.jsxs)("div",{className:"sidebar",children:[Object(N.jsxs)("div",{className:"sidebar__header",children:[Object(N.jsx)(o.a,{src:null===(t=e.user)||void 0===t?void 0:t.photoURL}),Object(N.jsxs)("div",{className:"sidebar__headerRight",children:[Object(N.jsx)(j.a,{children:Object(N.jsx)(l.a,{})}),Object(N.jsx)(j.a,{children:Object(N.jsx)(h.a,{})}),Object(N.jsx)(j.a,{children:Object(N.jsx)(m.a,{})})]})]}),Object(N.jsx)("div",{className:"sidebar__search",children:Object(N.jsxs)("div",{className:"sidebar__searchContainer",children:[Object(N.jsx)(O.a,{}),Object(N.jsx)("input",{placeholder:"Search or start new chat",onChange:function(e){return p(e.target.value)}})]})}),Object(N.jsxs)("div",{className:"sidebar__chats",children:[Object(N.jsx)(S,{addNewChat:!0}),n.map((function(e){var t;return(null===(t=e.data.name)||void 0===t?void 0:t.toLowerCase().includes(null===b||void 0===b?void 0:b.toLowerCase()))?Object(N.jsx)(S,{id:e.id,name:e.data.name},e.id):""}))]})]})},C=a(103),y=a(104),I=a(59),D=a.n(I),L=a(10),P=Object(c.createContext)(),R=function(e){var t=e.reducer,a=e.initialState,s=e.children;return Object(N.jsx)(P.Provider,{value:Object(c.useReducer)(t,a),children:s})},E=function(){return Object(c.useContext)(P)};function M(e){var t,a=Object(c.useState)(""),s=Object(r.a)(a,2),n=s[0],i=s[1],o=Object(c.useState)([]),j=Object(r.a)(o,2),d=j[0],l=j[1],u=Object(L.f)().roomId,h=Object(c.useState)(""),b=Object(r.a)(h,2),m=b[0],O=b[1],x=E(),v=Object(r.a)(x,2),f=v[0].user,_=(v[1],"https://avatars.dicebear.com/api/human/".concat(Math.round(5e3*Math.random()),".svg"));Object(c.useEffect)((function(){u&&(g.collection("rooms").doc(u).onSnapshot((function(e){return O(e.data().name)})),g.collection("rooms").doc(u).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){l(e.docs.map((function(e){return e.data()})))})))}),[u]);var S=[];d.map((function(e){e.name===f.displayName?S.push(Object(N.jsx)(F,{name:"You",message:e.messages,timestamp:e.timestamp,chatReceiver:!0})):S.push(Object(N.jsx)(F,{name:e.name,message:e.messages,timestamp:e.timestamp}))}));return Object(N.jsxs)("div",{className:"chat",children:[Object(N.jsx)(T,{name:m,src:_,timestamp:new Date(null===(t=d.lastItem)||void 0===t?void 0:t.timestamp).toLocaleTimeString()}),Object(N.jsx)("div",{class:"chat__body",children:S}),Object(N.jsx)(k,{onSubmit:function(e){e.preventDefault(),console.log(n),g.collection("rooms").doc(u).collection("messages").add({name:f.displayName,messages:n,timestamp:p.a.firestore.FieldValue.serverTimestamp()}),i("")},input:n,setinput:function(e){i(e)}})]})}function T(e){return Object(N.jsxs)("div",{className:"chat__header",children:[Object(N.jsx)(o.a,{src:e.src}),Object(N.jsxs)("div",{className:"chat__headerLeft",children:[Object(N.jsx)("h2",{children:e.name}),Object(N.jsxs)("p",{children:["Last seen at ",e.timestamp?e.timestamp:""]})]}),Object(N.jsxs)("div",{className:"chat__headerRight",children:[Object(N.jsx)(j.a,{children:Object(N.jsx)(O.a,{})}),Object(N.jsx)(j.a,{children:Object(N.jsx)(C.a,{})}),Object(N.jsx)(j.a,{children:Object(N.jsx)(m.a,{})})]})]})}function F(e){var t,a=e.chatReceiver?"chat__message chat__receiver":"chat__message",c=new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()),s=c.getDate()+"-"+c.getMonth()+" "+c.getHours()+":"+c.getMinutes();return Object(N.jsx)("div",{className:"",children:Object(N.jsxs)("p",{className:a,children:[Object(N.jsx)("span",{className:"chat__message__chatname",style:{color:"#42d09d"},children:e.name}),e.message,Object(N.jsx)("span",{className:"chat__message__timestamp",children:s})]})})}function k(e){return Object(N.jsxs)("div",{className:"chat__footer",children:[Object(N.jsx)(j.a,{children:Object(N.jsx)(y.a,{})}),Object(N.jsxs)("form",{onSubmit:function(t){return e.onSubmit(t)},children:[Object(N.jsx)("input",{type:"text",placeholder:"Type a message",value:e.input,onChange:function(t){e.setinput(t.target.value)}}),Object(N.jsx)("button",{children:"Send a Message"})]}),Object(N.jsx)(j.a,{children:Object(N.jsx)(D.a,{})})]})}a(85);var A=a(60),B=a(105),z=(a(86),a(50)),G="SET_USER",H=function(e,t){switch(t.type){case G:return Object(z.a)(Object(z.a)({},e),{},{user:t.user});default:return e}};function J(){var e=E(),t=Object(r.a)(e,2);Object(A.a)(t[0]);var a=t[1];return Object(N.jsx)("div",{className:"login",children:Object(N.jsxs)("div",{className:"login__container",children:[Object(N.jsx)("div",{className:"img"}),Object(N.jsx)("h2",{children:"Sign in to What'sApp"}),Object(N.jsx)("h3",{children:"Sign in using Google"}),Object(N.jsx)(B.a,{onClick:function(){v.signInWithPopup(f).then((function(e){a({type:G,user:e.user})})).catch((function(e){alert(e.message)}))},children:"SignIn"})]})})}var U=function(){var e=E(),t=Object(r.a)(e,2),a=t[0].user;return t[1],Object(N.jsx)("div",{children:null==a?Object(N.jsx)(J,{}):Object(N.jsx)("div",{className:"app",children:Object(N.jsx)("div",{className:"app__body",children:Object(N.jsxs)(_.a,{children:[Object(N.jsx)(w,{user:a}),Object(N.jsxs)(L.c,{children:[Object(N.jsx)(L.a,{path:"/rooms/:roomId",children:Object(N.jsx)(M,{})}),Object(N.jsx)(L.a,{path:"/",children:Object(N.jsx)(M,{})})]})]})})})})},W=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,107)).then((function(t){var a=t.getCLS,c=t.getFID,s=t.getFCP,n=t.getLCP,i=t.getTTFB;a(e),c(e),s(e),n(e),i(e)}))};i.a.render(Object(N.jsx)(s.a.StrictMode,{children:Object(N.jsx)(R,{initialState:{user:null},reducer:H,children:Object(N.jsx)(U,{})})}),document.getElementById("root")),W()}},[[87,1,2]]]);
//# sourceMappingURL=main.4dc72dd0.chunk.js.map